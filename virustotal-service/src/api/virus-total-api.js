'use strict'

module.exports = (app, options) => {
    const {repo} = options
    //This function gets virustotal data via signature
app.post('/getVirusTotalSignatureViaBot', (req, res, next) => {
    repo.getVirusTotalSignatureViaBot(req.query.hash)
    .then(results => {
        res.send(results)
    })
    .catch(next)
})

app.post('/getVirusTotalDomainViaBot', (req, res, next) => {
    repo.getVirusTotalDomainViaBot(req.query.domain)
    .then(results => {
        res.send(results)
    })
    .catch(next)
    });

app.post('/getVirusTotalUrlViaBot', (req, res, next => {
    repo.getVirusTotalUrlViaBot(req.query.url)
    .then(results => {
        res.send(results)
    })
    .catch(next)
    }));


app.post('/getVirusTotalIpViaBot', (req, res, next => {
    repo.getVirusTotalIpViaBot(req.query.ip)
    .then(results => {
        res.send(results)
    })
    .catch(next)
    }));


}



