'use strict'

module.exports = (app, options) => {
    const {repo} = options
    //This function gets virustotal data via signature
app.post('/getVirusTotalSignatureViaBot', (argument) => {
    repo.getVirusTotalSignatureViaBot(argument.req.query.hash)
    .then(results => {
        argument.res.send(results)
    })
    .catch(argument.next)
})

app.post('/getVirusTotalDomainViaBot', (req, res, next) => {
    repo.getVirusTotalDomainViaBot(req.query.domain)
    .then(results => {
        res.send(results)
    })
    .catch(next)
    });

app.post('/getVirusTotalUrlViaBot', (argument => {
    repo.getVirusTotalUrlViaBot(argument.req.query.url)
    .then(results => {
        argument.res.send(results)
    })
    .catch(argument.next)
    }));


app.post('/getVirusTotalIpViaBot', (argument => {
    repo.getVirusTotalIpViaBot(argument.req.query.ip)
    .then(results => {
        argument.res.send(results)
    })
    .catch(argument.next)
    }));


}



