'use strict'

const {EventEmitter} = require('events')
const app = require('./app/app')
const emiter = new EventEmitter()
const server = require('./app/app')
const repository = require('./repository/repository')
api_key = 'bc9b42cf3bbaf3ffe4ae7f538b34774310fa49e4614d48a90ccbb171a9e553bc'

process.on('uncaughtException', (err) => {
    console.error('Uncaught exception', err)
})

process.on('uncaughtRejection', (err, promise) => {
    console.error('Uncaught rejection', err)
})

let reposit
const connection = repository.virus_total_connect(api_key)
.then(repo =>{
    console.log('virus total connected')

    reposit = repo

    return server.start({port: 9000, reposit})
})


emiter.emit('boot ready')